function showErrorAlert(e){var r=$("#alert-error-div"),t=$("#alert-error-div > .alert.alert-danger");t.text(e),r.slideDown().addClass("is-visible")}function showPageLoader(){$pageLoaderModal.modal({backdrop:"static",keyboard:!1,show:!0}),$(".progress-bar").css("width","100%")}function authenticateUser(){request&&request.abort();var e={};e.role=sessionStorage.getItem("role"),e.username=sessionStorage.getItem("username"),e.uid=sessionStorage.getItem("uid"),"admin"==e.role,e.uid.indexOf("AD")>=0&&(request=$.ajax({url:"../php/adminValidator.php",type:"post",data:e}),request.done(accessValidSuccess),request.fail(accessValidError))}function checkAdminDetails(e){var r=0;return sessionStorage.getItem("username")!=e.user.username?r++:sessionStorage.getItem("role")!=e.user.role?r++:sessionStorage.getItem("uid")!=e.user.uid&&r++,0==r}function accessValidSuccess(e,r,t){return"object"!=typeof e?void showErrorAlert("Seems Like an error on server end, Please Contact Developer"):e.error?void showErrorAlert(e.message):void(checkAdminDetails(e)&&setupCrmPage(e,function(){$pageLoaderModal.modal("hide")}))}function accessValidError(e,r,t){showErrorAlert("Please Check Your Internet Connection")}function setupTable(e,r,t){var a=$("#info-body-row"),s=$("#transaction-body");"object"!=typeof e&&a.html("<div class='col-md-12'><div class='alert alert-danger'>"+e.message+"</div>"),e.error&&a.html("<div class='col-md-12'><div class='alert alert-danger'>"+e.message+"</div>");for(var o="",n=0;n<e.transactions.length;n++)x+="<tr><td>"+e.transactions[n].created_at+"</td><td data-uid="+e.transactions[n].uid+">"+e.transactions[n].uid+"</td><td>"+e.transactions[n].card_cust_name+"</td><td>"+e.transactions[n].amount+"</td><td>"+e.transactions[n].user+"</td><td>"+e.transactions[n].source+"</td></tr>";s.html(o),console.log(e.transactions)}function setupTableError(e,r,t){var a=$("#info-body-row");a.html("<div class='col-md-12'><div class='alert alert-danger'>"+response.message+"</div>")}function setupCrmPage(e,r){var t=$("a#username"),a=$("a#uid"),s=$("a#role");t.text(e.user.username),a.text(e.user.uid),s.text(e.user.role),request=$.ajax({url:"../php/getTransactions.php",type:"get"}),request.done(setupTable),request.fail(setupTableError),r()}function checkForUsage(){var e=$("#infoModal"),r=($("#formModal"),$("#search-btn")),t=$("#update-btn");r.click(function(){e.modal("show")}),t.click(function(){e.modal("show")})}var request,$pageLoaderModal=$("#pageLoaderModal");$(function(){showPageLoader(),checkForUsage(),authenticateUser()});