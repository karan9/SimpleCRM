function showErrorAlert(e){var a=$("#alert-error-div"),r=$("#alert-error-div > .alert.alert-danger");r.text(e),a.slideDown().addClass("is-visible")}function showPageLoader(){$pageLoaderModal.modal({backdrop:"static",keyboard:!1,show:!0}),$(".progress-bar").css("width","100%")}function authenticateUser(){request&&request.abort();var e={};e.role=sessionStorage.getItem("role"),e.username=sessionStorage.getItem("username"),e.uid=sessionStorage.getItem("uid"),"admin"==e.role,e.uid.indexOf("AD")>=0&&(request=$.ajax({url:"../php/adminValidator.php",type:"post",data:e}),request.done(accessValidSuccess),request.fail(accessValidError))}function checkAdminDetails(e){var a=0;return sessionStorage.getItem("username")!=e.user.username?a++:sessionStorage.getItem("role")!=e.user.role?a++:sessionStorage.getItem("uid")!=e.user.uid&&a++,0==a}function accessValidSuccess(e,a,r){return"object"!=typeof e?void showErrorAlert("Seems Like an error on server end, Please Contact Developer"):e.error?void showErrorAlert(e.message):void(checkAdminDetails(e)&&setupCrmPage(e,function(){$pageLoaderModal.modal("hide")}))}function accessValidError(e,a,r){showErrorAlert("Please Check Your Internet Connection")}function setupTable(e,a,r){var t=$("#info-body-row"),s=$("#transaction-body");"object"!=typeof e&&t.html("<div class='col-md-12'><div class='alert alert-danger'>"+e.message+"</div>"),e.error&&t.html("<div class='col-md-12'><div class='alert alert-danger'>"+e.message+"</div>");for(var o="",n=0;n<e.transactions.length;n++)x+="<tr><td>"+e.transactions[n].created_at+"</td><td data-uid="+e.transactions[n].uid+">"+e.transactions[n].uid+"</td><td>"+e.transactions[n].card_cust_name+"</td><td>"+e.transactions[n].amount+"</td><td>"+e.transactions[n].user+"</td><td>"+e.transactions[n].source+"</td></tr>";s.html(o),console.log(e.transactions)}function setupTableError(e,a,r){var t=$("#info-body-row");t.html("<div class='col-md-12'><div class='alert alert-danger'>"+response.message+"</div>")}function setupCrmPage(e,a){var r=$("a#username"),t=$("a#uid"),s=$("a#role");r.text(e.user.username),t.text(e.user.uid),s.text(e.user.role),request=$.ajax({url:"../php/getTransactions.php",type:"get"}),request.done(setupTable),request.fail(setupTableError),a()}function checkForUsage(){var e=$("#infoModal"),a=$("#formModal"),r=$("#search-btn"),t=$("#update-btn"),s=$("#formModal-form");r.click(function(){a.modal("show")}),t.click(function(){e.modal("show")}),$("#formModalSelect").change(function(){"UID"==this.value?($("#transaction-term").slideDown().addClass("is-visible"),$("#card-number").hide(),$("#date").hide()):"CARD"==this.value?($("#card-number").slideDown().addClass("is-visible"),$("#transaction-term").hide(),$("#date").hide()):"DAY"==this.value?($("#date").slideDown().addClass("is-visible"),$("#card-number").hide(),$("#transaction-term").hide()):$("#transaction-term").slideDown().addClass("is-visible")}),s.submit(function(e){e.preventDefault(),$data=s.serialize();var a=s.find("input, select, button, textarea");a.prop("disabled",!0),request&&request.abort(),request=$.ajax({url:"../php/searchTransaction.php",type:"get"}),request.done(setupSearchTable),request.fail(setupSearchTableError)})}function setupSearchTable(e,a,r){}function setupSearchTableError(e,a,r){}var request,$pageLoaderModal=$("#pageLoaderModal");$(function(){checkForUsage(),authenticateUser()});